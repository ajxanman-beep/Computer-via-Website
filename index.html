<!DOCTYPE html>
<html>
<head>
    <title>Remote PC Pro</title>
    <style>
        body { font-family: sans-serif; background: #000; color: white; text-align: center; margin: 0; overflow: hidden; }
        .bar { background: #222; padding: 10px; display: flex; justify-content: center; gap: 15px; }
        #pc-screen { width: 95vw; max-width: 1100px; border: 2px solid #444; margin-top: 10px; cursor: crosshair; user-select: none; -webkit-user-drag: none; }
        .hint { font-size: 11px; color: #777; margin-top: 5px; }
    </style>
</head>
<body>

    <div class="bar">
        <span>ğŸ“¶ Status: <b id="stat">Connecting...</b></span>
        <button onmousedown="sendSimple('scroll_up')">ğŸ”¼ Scroll Up</button>
        <button onmousedown="sendSimple('scroll_down')">ğŸ”½ Scroll Down</button>
    </div>

    <img id="pc-screen" 
         onmousedown="handleMouse(event, 'mousedown')" 
         onmouseup="handleMouse(event, 'mouseup')" 
         oncontextmenu="handleMouse(event, 'right_click'); return false;"
         src="" />

    <div class="hint">âŒ¨ï¸ Hold keys to walk/type | ğŸ–±ï¸ Drag to move items | ğŸ–±ï¸ Right-click enabled</div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getDatabase, ref, set, onValue } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        const firebaseConfig = {
            apiKey: "AIzaSyAHQaoPEVTaJ8WwkHlYDdpwA-lWxYVnOts",
            authDomain: "website-computer-fe00c.firebaseapp.com",
            databaseURL: "https://website-computer-fe00c-default-rtdb.firebaseio.com",
            projectId: "website-computer-fe00c"
        };

        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);
        const cmdRef = ref(db, 'pc_control/command');

        // MOUSE: DRAGGING & CLICKS
        window.handleMouse = function(e, type) {
            const rect = e.target.getBoundingClientRect();
            const x = (e.clientX - rect.left) / rect.width;
            const y = (e.clientY - rect.top) / rect.height;
            set(cmdRef, { action: type, x: x, y: y, timestamp: Date.now() });
        };

        window.sendSimple = (act) => set(cmdRef, { action: act, timestamp: Date.now() });

        // KEYBOARD: HOLDING SUPPORT
        const pressedKeys = new Set();

        window.addEventListener('keydown', (e) => {
            if (pressedKeys.has(e.code)) return; // Prevent repeat fire
            pressedKeys.add(e.code);
            
            let k = e.key.toLowerCase();
            if (k === " ") k = "space";
            set(cmdRef, { action: 'keydown', key: k, timestamp: Date.now() });
        });

        window.addEventListener('keyup', (e) => {
            pressedKeys.delete(e.code);
            let k = e.key.toLowerCase();
            if (k === " ") k = "space";
            set(cmdRef, { action: 'keyup', key: k, timestamp: Date.now() });
        });

        // STREAMING
        onValue(ref(db, 'pc_control/stream'), (s) => {
            const data = s.val();
            if (data) {
                document.getElementById('pc-screen').src = "data:image/webp;base64," + data;
                document.getElementById('stat').innerText = "LIVE";
            }
        });
    </script>
</body>
</html>
